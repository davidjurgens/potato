# Adjudication Example Configuration
#
# This example demonstrates the adjudication workflow where designated
# reviewers resolve disagreements between annotators.
#
# Pre-loaded annotations from user_1, user_2, and user_3 are included
# so the adjudication queue is populated immediately on startup.
#
# Run from the repository root:
#   python potato/flask_server.py start project-hub/simple_examples/simple-adjudication/config.yaml -p 8000
#
# Then login as "adjudicator" and navigate to /adjudicate to review items.

annotation_task_name: "Sentiment Adjudication Demo"

data_files:
  - "data/adjudication-example.json"

item_properties:
  id_key: "id"
  text_key: "text"

task_dir: "."
output_annotation_dir: "annotation_output"

# Allow multiple annotators per item
max_annotations_per_item: 3

# Simple password-free login for demo
user_config:
  allow_anonymous: true

# Admin API key for the admin overview endpoint
admin_api_key: "demo-admin-key"

annotation_schemes:
  - annotation_type: "radio"
    name: "sentiment"
    description: "What is the overall sentiment of this text?"
    labels:
      - "positive"
      - "negative"
      - "neutral"
      - "mixed"

  - annotation_type: "multiselect"
    name: "topics"
    description: "What topics are discussed? (Select all that apply)"
    labels:
      - "food"
      - "service"
      - "price"
      - "ambiance"
      - "recommendation"

# Adjudication configuration
adjudication:
  enabled: true
  adjudicator_users:
    - "adjudicator"

  # Items become eligible after 2 annotations
  min_annotations: 2

  # Show items with agreement below 75%
  agreement_threshold: 0.75

  # Show all items including unanimous ones (for demo purposes)
  show_all_items: true

  # Display options
  show_annotator_names: true
  show_timing_data: true
  show_agreement_scores: true
  fast_decision_warning_ms: 2000

  # Require confidence rating
  require_confidence: true

  # Error categories for classification
  error_taxonomy:
    - "ambiguous_text"
    - "guideline_gap"
    - "annotator_error"
    - "edge_case"
    - "subjective_disagreement"

  output_subdir: "adjudication"

  # Uncomment to enable semantic similarity (requires sentence-transformers):
  # similarity:
  #   enabled: true
  #   model: "all-MiniLM-L6-v2"
  #   top_k: 5
  #   precompute_on_start: true

# MACE competence estimation (optional)
# Estimates annotator reliability and predicts true labels using EM algorithm.
# Results are available via /admin/api/mace/overview and surfaced in adjudication UI.
# mace:
#   enabled: true
#   trigger_every_n: 10        # Run after every N new annotations
#   min_annotations_per_item: 3  # Need >= this many annotators per item
#   min_items: 5               # Need >= this many eligible items

# Debug mode for easy testing
debug: true
