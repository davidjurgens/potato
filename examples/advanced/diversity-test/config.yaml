# Diversity Ordering Manual Test
#
# This example has 100 items across 5 themes (Sports, Technology, Food, Travel, Health)
# with 20 items per theme. Diversity ordering will cluster items and present them
# round-robin from different clusters to maximize variety.
#
# Run from the repository root:
#   python potato/flask_server.py start examples/advanced/diversity-test/config.yaml -p 8000
#
# To test reordering behavior:
# 1. Log in and observe items are from diverse topics
# 2. Annotate items - after sampling from all 5 clusters, reclustering may occur
# 3. Navigate back - annotated items should stay in their positions
# 4. Check server logs for "Reclustering" messages

annotation_task_name: "Diversity Ordering Test (100 items, 5 themes)"

# Use diversity clustering for item ordering
assignment_strategy: diversity_clustering

# Diversity ordering configuration
diversity_ordering:
  enabled: true

  # Sentence-transformer model for computing embeddings
  model_name: "all-MiniLM-L6-v2"

  # Fixed 5 clusters to match 5 themes
  num_clusters: 5
  auto_clusters: false

  # Compute embeddings for all 100 items at startup
  prefill_count: 100
  batch_size: 16

  # Recluster when user has sampled from all clusters (100%)
  # Change to 0.5 to trigger reclustering after sampling 3 of 5 clusters
  recluster_threshold: 1.0

  # Keep annotated and visited items in their positions
  preserve_visited: true

# Data configuration
task_dir: .
data_files:
  - data/test_data.json

output_annotation_dir: annotation_output

# Item display configuration
item_properties:
  id_key: id
  text_key: text

# Annotation schema - classify the topic of each text
annotation_schemes:
  - annotation_type: radio
    name: topic
    description: "What is the main topic of this text?"
    labels:
      - name: Sports
        tooltip: "Content about athletic competitions, teams, or players"
      - name: Technology
        tooltip: "Content about computers, software, gadgets, or tech companies"
      - name: Food
        tooltip: "Content about cooking, restaurants, or culinary topics"
      - name: Travel
        tooltip: "Content about destinations, tourism, or journeys"
      - name: Health
        tooltip: "Content about medicine, fitness, or wellness"

# User configuration - allow anyone to annotate
user_config:
  allow_all_users: true
  users: []

# Server settings
server:
  port: 8000
  debug: true
